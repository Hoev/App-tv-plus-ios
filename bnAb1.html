<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TV Player</title>

<script src="https://cdn.jsdelivr.net/npm/jwplayer@8.32.0/jwplayer.js"></script>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: black;
  overflow: hidden;
}
#player {
  width: 100%;
  height: 100%;
}

#qualityMenu {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 99999;
  background: rgba(0,0,0,0.6);
  padding: 10px 12px;
  border-radius: 12px;
  color: white;
  font-family: sans-serif;
  display: none;
}

#qualityMenu div {
  padding: 6px 10px;
  cursor: pointer;
  font-size: 16px;
}

#qualityMenu div:hover {
  background: #f44336;
  border-radius: 6px;
}
</style>
</head>
<body>

<div id="player"></div>

<div id="qualityMenu"></div>

<script>
jwplayer.key = "XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo";

// رابط متعدد الدقة (بعد التصحيح)
const streamUrl =
  "https://prod-fastly-eu-central-1.video.pscp.tv/Transcoding/v1/hls/Ozl9eei_79-HW10_b6E_0SY-Gp74OtjT_lFme7LPF92Bjs4TtYOqVvL7QbDPPfTKdJyaOg-gf7CSGMX5SDZRFQ/non_transcode/eu-central-1/periscope-replay-direct-prod-eu-central-1-public/master_dynamic_highlatency.m3u8?type=live";

// إعداد المشغل
const player = jwplayer("player").setup({
  file: streamUrl,
  type: "hls",
  autostart: true,
  controls: true,
  width: "100%",
  height: "100%",
  stretching: "uniform"
});

// بعد تحميل الفيديو – الحصول على الدقات
player.on("levels", function() {
  const levels = player.getQualityLevels();
  const menu = document.getElementById("qualityMenu");
  menu.innerHTML = "";

  levels.forEach((level, index) => {
    const item = document.createElement("div");
    item.innerText = level.label || `دقة ${index+1}`;
    item.onclick = () => player.setCurrentQuality(index);
    menu.appendChild(item);
  });
});

// جعل القائمة تظهر وتختفي مع الأزرار
player.on("controls", function(e) {
  const menu = document.getElementById("qualityMenu");
  menu.style.display = e.controls ? "block" : "none";
});
</script>

</body>
</html>